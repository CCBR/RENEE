<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=CCBR><link rel="shortcut icon" href=../../img/favicon.ico><title>build - RENEE Documentation</title><link rel=stylesheet href=../../css/theme.css><link rel=stylesheet href=../../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><link href=../../css/custom.css rel=stylesheet><link href=../../css/version-select.css rel=stylesheet><script>
        // Current page data
        var mkdocs_page_name = "build";
        var mkdocs_page_input_path = "RNA-seq/build.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=../.. class="icon icon-home"> RENEE Documentation </a><div role=search> <form id=rtd-search-form class=wy-form action=../../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=../..>About</a> </li> </ul> <ul> <li class=toctree-l1><a href=../Theory/ class="reference internal">Theory</a> </li> </ul> <ul> <li class=toctree-l1><a href=../TLDR-RNA-seq/ class="reference internal">Getting started</a> </li> </ul> <p class=caption><span class=caption-text>Command Line</span></p> <ul class=current> <li class=toctree-l1><a href=../run/ class="reference internal">run</a> </li> <li class="toctree-l1 current"><a class="reference internal current" href=#>build</a> <ul class=current> <li class=toctree-l2><a class="reference internal" href=#1-about>1. About</a> </li> <li class=toctree-l2><a class="reference internal" href=#2-synopsis>2. Synopsis</a> <ul> <li class=toctree-l3><a class="reference internal" href=#21-required-arguments>2.1 Required Arguments</a> </li> <li class=toctree-l3><a class="reference internal" href=#22-build-options>2.2 Build Options</a> </li> <li class=toctree-l3><a class="reference internal" href=#23-orchestration-options>2.3 Orchestration Options</a> </li> <li class=toctree-l3><a class="reference internal" href=#24-misc-options>2.4 Misc Options</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#3-hybrid-genomes>3. Hybrid Genomes</a> </li> <li class=toctree-l2><a class="reference internal" href=#4-convert-ncbi-gff3-to-gtf-format>4. Convert NCBI GFF3 to GTF format</a> </li> <li class=toctree-l2><a class="reference internal" href=#5-example>5. Example</a> <ul> <li class=toctree-l3><a class="reference internal" href=#51-biowulf>5.1 Biowulf</a> </li> <li class=toctree-l3><a class="reference internal" href=#52-generic-slurm-cluster>5.2 Generic SLURM Cluster</a> </li> </ul> </li> </ul> </li> <li class=toctree-l1><a href=../cache/ class="reference internal">cache</a> </li> <li class=toctree-l1><a href=../unlock/ class="reference internal">unlock</a> </li> </ul> <ul> <li class=toctree-l1><a href=../gui/ class="reference internal">Graphical Interface</a> </li> </ul> <ul> <li class=toctree-l1><a href=../output/ class="reference internal">Expected Output</a> </li> </ul> <ul> <li class=toctree-l1><a href=../Resources/ class="reference internal">Resources</a> </li> </ul> <p class=caption><span class=caption-text>FAQ</span></p> <ul> <li class=toctree-l1><a href=../../general-questions/ class="reference internal">General Questions</a> </li> <li class=toctree-l1><a href=../../troubleshooting/ class="reference internal">Troubleshooting</a> </li> <li class=toctree-l1><a href=../../contributing/ class="reference internal">How to contribute</a> </li> </ul> <ul> <li class=toctree-l1><a href=../../license/ class="reference internal">License</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=../..>RENEE Documentation</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=../.. class="icon icon-home" aria-label=Docs></a></li> <li class=breadcrumb-item>Command Line</li> <li class="breadcrumb-item active">build</li> <li class=wy-breadcrumbs-aside> <a href=https://github.com/CCBR/RENEE/edit/master/docs/RNA-seq/build.md>Edit on CCBR/RENEE</a> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=renee-build><code>renee <b>build</b></code><a class=headerlink href=#renee-build title="Permanent link">&para;</a></h1> <h2 id=1-about>1. About<a class=headerlink href=#1-about title="Permanent link">&para;</a></h2> <p>The <code>renee</code> executable is composed of several inter-related sub commands. Please see <code>renee -h</code> for all available options.</p> <p>This part of the documentation describes options and concepts for <code>renee <b>build</b></code> sub command in more detail. With minimal configuration, the <strong><code>build</code></strong> sub command enables you to build new reference files for the renee run pipeline.</p> <p>Setting up the RENEE build pipeline is fast and easy! In its most basic form, <code>renee <b>build</b></code> only has <em>five required inputs</em>.</p> <h2 id=2-synopsis>2. Synopsis<a class=headerlink href=#2-synopsis title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code>$ renee build [--help] \
             [--shared-resources SHARED_RESOURCES] [--small-genome] \
             [--dry-run] [--partition PARTITION] \
             [--singularity-cache SINGULARITY_CACHE] \
             [--sif-cache SIF_CACHE] [--tmp-dir TMP_DIR] \
             --ref-fa REF_FA \
             --ref-name REF_NAME \
             --ref-gtf REF_GTF \
             --gtf-ver GTF_VER \
             --output OUTPUT
</code></pre></div> <p>The synopsis for each command shows its parameters and their usage. Optional parameters are shown in square brackets.</p> <p>A user <strong>must</strong> provide the genomic sequence of the reference's assembly in FASTA format via <code>--ref-fa</code> argument, an alias for the reference genome via <code>--ref-name</code> argument, a gene annotation for the reference assembly via <code>--ref-gtf</code> argument, an alias or version for the gene annotation via the <code>--gtf-ver</code> argument, and an output directory to store the built reference files via <code>--output</code> argument. If you are running the pipeline outside of Biowulf, you will need to additionally provide the the following options: <code>--shared-resources</code>, <code>--tmp-dir</code>. More information about each of these options can be found below.</p> <p>For <a href=https://www.gencodegenes.org/human/ >human</a> and <a href=https://www.gencodegenes.org/mouse/ >mouse</a> data, we highly recommend downloading the latest available <strong>PRI</strong> genome assembly and corresponding gene annotation from <a href=https://www.gencodegenes.org/ >GENCODE</a>. These reference files contain chromosomes and scaffolds sequences.</p> <p>The build pipeline will generate a JSON file containing key, value pairs to required reference files for the <code>renee <b>run</b></code> pipeline. This file will be located in the path provided to <code>--output</code>. The name of this JSON file is dependent on the values provided to <code>--ref-name</code> and <code>--gtf-ver</code> and has the following naming convention: <code>{OUTPUT}/{REF_NAME}_{GTF_VER}.json</code>. Once the build pipeline completes, this reference JSON file can be passed to the <code>--genome</code> option of <code>renee <b>run</b></code>. This is how new references are built for the RENEE pipeline.</p> <p>Use you can always use the <code>-h</code> option for information on a specific command.</p> <h3 id=21-required-arguments>2.1 Required Arguments<a class=headerlink href=#21-required-arguments title="Permanent link">&para;</a></h3> <p>Each of the following arguments are required. Failure to provide a required argument will result in a non-zero exit-code.</p> <p><code>--ref-fa REF_FA</code></p> <blockquote> <p><strong>Genomic FASTA file of the reference genome.</strong><br> <em>type: file</em></p> <p>This file represents the genome sequence of the reference assembly in FASTA format. If you are downloading this from GENCODE, you should select the <em>PRI</em> genomic FASTA file. This file will contain the primary genomic assembly (contains chromosomes and scaffolds). This input file should not be compressed. Sequence identifiers in this file must match with sequence identifiers in the GTF file provided to <code>--ref-gtf</code>.</p> <p><strong><em>Example:</em></strong> &gt; <code>--ref-fa GRCh38.primary_assembly.genome.fa</code></p> </blockquote> <hr> <p><code>--ref-name REF_NAME</code></p> <blockquote> <p><strong>Name of the reference genome.</strong><br> <em>type: string</em></p> <p>Name or alias for the reference genome. This can be the common name for the reference genome. Here is a list of common examples for different model organisms: mm10, hg38, rn6, danRer11, dm6, canFam3, sacCer3, ce11. If the provided values contains one of the following sub-strings (hg19, hs37d, grch37, hg38, hs38d, grch38, mm10, grcm38), then Arriba will run with its corresponding blacklist.</p> <p><strong><em>Example:</em></strong> <code>--ref-name hg38</code></p> </blockquote> <hr> <p><code>--ref-gtf REF_GTF</code></p> <blockquote> <p><strong>Gene annotation or GTF file for the reference genome.</strong><br> <em>type: file</em></p> <p>This file represents the reference genome's gene annotation in GTF format. If you are downloading this from GENCODE, you should select the 'PRI' GTF file. This file contains gene annotations for the primary assembly (contains chromosomes and scaffolds). This input file should not be compressed. Sequence identifiers (column 1) in this file must match with sequence identifiers in the FASTA file provided to <code>--ref-fa</code>.<br> <strong><em>Example:</em></strong> <code>--ref-gtf gencode.v36.primary_assembly.annotation.gtf</code></p> </blockquote> <hr> <p><code>--gtf-ver GTF_VER</code></p> <blockquote> <p><strong>Version of the gene annotation or GTF file provided.</strong><br> <em>type: string or int</em></p> <p>This is the version of the supplied gene annotation or GTF file. If you are using a GTF file from GENCODE, use the release number or version (i.e. <em>M25</em> for mouse or <em>37</em> for human). Visit gencodegenes.org for more details.<br> <strong><em>Example:</em></strong> <code>--gtf-ver 36</code></p> </blockquote> <hr> <p><code>--output OUTPUT</code></p> <blockquote> <p><strong>Path to an output directory.</strong><br> <em>type: path</em></p> <p>This location is where the build pipeline will create all of its output files. If the user-provided working directory has not been initialized, it will automatically be created. Note: by default, any files in <code>config</code>, <code>resources,</code> or <code>workflow</code> in the output directory may be overwritten by <code>renee build</code>. <strong><em>Example:</em></strong> <code>--output /data/$USER/refs/hg38_36/</code></p> </blockquote> <h3 id=22-build-options>2.2 Build Options<a class=headerlink href=#22-build-options title="Permanent link">&para;</a></h3> <p>Each of the following arguments are optional and do not need to be provided. If you are running the pipeline outside of Biowulf, the <code>--shared-resources</code> option only needs to be provided at least once. This will ensure reference files that are shared across different genomes are downloaded locally.</p> <p><code>--shared-resources SHARED_RESOURCES</code></p> <blockquote> <p><strong>Local path to shared resources.</strong><br> <em>type: path</em></p> <p>The pipeline uses a set of shared reference files that can be re-used across reference genomes. These currently include reference files for kraken and FQScreen. These reference files can be downloaded with the build sub command's <code>--shared-resources</code> option. With that being said, these files only need to be downloaded once. We recommend storing this files in a shared location on the filesystem that other people can access. If you are running the pipeline on Biowulf, you do NOT need to download these reference files! They already exist on the filesystem in a location that anyone can access; however, if you are running the pipeline on another cluster or target system, you will need to download the shared resources with the build sub command, and you will need to provide this option every time you run the pipeline. Please provide the same path that was provided to the build sub command's --shared-resources option. Again, if you are running the pipeline on Biowulf, you do NOT need to provide this option. For more information about how to download shared resources, please reference the build sub command's <code>--shared-resources</code> option.</p> <p><strong><em>Example:</em></strong> <code>--shared-resources /data/shared/renee</code></p> </blockquote> <hr> <p><code>--small-genome</code></p> <blockquote> <p><strong>Builds a small genome index.</strong><br> <em>type: boolean</em></p> <p>For small genomes, it is recommended running STAR with a scaled down <code>--genomeSAindexNbases</code> value. This option runs the build pipeline in a mode where it dynamically finds the optimal value for this option using the following formula: <code>min(14, log2(GenomeSize)/2 - 1)</code>. Generally speaking, this option is not really applicable for most mammalian reference genomes, i.e. human and mouse; however, researcher working with very small reference genomes, like S. cerevisiae ~ 12Mb, should provide this option.</p> <p>When in doubt feel free to provide this option, as the optimal value will be found based on your input.</p> <p><strong><em>Example:</em></strong> <code>--small-genome</code></p> </blockquote> <h3 id=23-orchestration-options>2.3 Orchestration Options<a class=headerlink href=#23-orchestration-options title="Permanent link">&para;</a></h3> <p><code>--dry-run</code></p> <blockquote> <p><strong>Dry run the build pipeline.</strong><br> <em>type: boolean</em></p> <p>Displays what steps in the build pipeline remain or will be run. Does not execute anything!</p> <p><strong><em>Example:</em></strong> <code>--dry-run</code></p> </blockquote> <hr> <p><code>--partition PARTITION</code></p> <blockquote> <p><strong>SLURM partition for job submission.</strong><br> <em>type: string</em></p> <p>Name of the SLURM partition to submit the build job to. This option overrides the default partition specified in the cluster configuration file. This is useful when you want to submit jobs to a specific partition on your SLURM cluster. If not provided, the default partition from the cluster configuration will be used.</p> <p><strong><em>Example:</em></strong> <code>--partition norm</code></p> </blockquote> <hr> <p><code>--singularity-cache SINGULARITY_CACHE</code></p> <blockquote> <p><strong>Overrides the $SINGULARITY_CACHEDIR environment variable.</strong><br> <em>type: path</em><br> <em>default: <code>--output OUTPUT/.singularity</code></em></p> <p>Singularity will cache image layers pulled from remote registries. This ultimately speeds up the process of pull an image from DockerHub if an image layer already exists in the singularity cache directory. By default, the cache is set to the value provided to the <code>--output</code> argument. Please note that this cache cannot be shared across users. Singularity strictly enforces you own the cache directory and will return a non-zero exit code if you do not own the cache directory! See the <code>--sif-cache</code> option to create a shareable resource.</p> <p><strong><em>Example:</em></strong> <code>--singularity-cache /data/$USER/.singularity</code></p> </blockquote> <hr> <p><code>--sif-cache SIF_CACHE</code></p> <blockquote> <p><strong>Path where a local cache of SIFs are stored.</strong><br> <em>type: path</em></p> <p>Uses a local cache of SIFs on the filesystem. This SIF cache can be shared across users if permissions are set correctly. If a SIF does not exist in the SIF cache, the image will be pulled from Dockerhub and a warning message will be displayed. The <code>renee cache</code> subcommand can be used to create a local SIF cache. Please see <code>renee cache</code> for more information. This command is extremely useful for avoiding DockerHub pull rate limits. It also remove any potential errors that could occur due to network issues or DockerHub being temporarily unavailable. We recommend running RENEE with this option when ever possible.</p> <p><strong><em>Example:</em></strong> <code>--singularity-cache /data/$USER/SIFs</code></p> </blockquote> <hr> <p><code>--tmp-dir TMP_DIR</code></p> <blockquote> <p><strong>Path on the file system for writing temporary files.</strong><br> <em>type: path</em><br> <em>default: <code>/lscratch/$SLURM_JOBID</code></em></p> <p>Path on the file system for writing temporary output files. By default, the temporary directory is set to '/lscratch/$SLURM_JOBID' on NIH's Biowulf cluster and 'OUTPUT' on the FRCE cluster. However, if you are running the pipeline on another cluster, this option will need to be specified. Ideally, this path should point to a dedicated location on the filesystem for writing tmp files. On many systems, this location is set to somewhere in /scratch. If you need to inject avariable into this string that should NOT be expanded,please quote this options value in single quotes.</p> <p><strong><em>Example:</em></strong> <code>--tmp-dir /cluster_scratch/$USER/</code></p> </blockquote> <h3 id=24-misc-options>2.4 Misc Options<a class=headerlink href=#24-misc-options title="Permanent link">&para;</a></h3> <p>Each of the following arguments are optional and do not need to be provided.</p> <p><code>-h, --help</code></p> <blockquote> <p><strong>Display Help.</strong><br> <em>type: boolean</em></p> <p>Shows command's synopsis, help message, and an example command</p> <p><strong><em>Example:</em></strong> <code>--help</code></p> </blockquote> <h2 id=3-hybrid-genomes>3. Hybrid Genomes<a class=headerlink href=#3-hybrid-genomes title="Permanent link">&para;</a></h2> <p>If you have two GTF files, e.g. hybrid genomes (host + virus), then you need to create one genomic FASTA file and one GTF file for the hybrid genome prior to running the <code>renee <b>build</b></code> command.</p> <p>We recommend creating an artificial chromosome for the non-host sequence. The sequence identifier in the FASTA file must match the sequence identifier in the GTF file (column 1). Generally speaking, since the host annotation is usually downloaded from Ensembl or GENCODE, it will be correctly formatted; however, that may not be the case for the non-host sequence!</p> <p>Please ensure the non-host annotation contains the following features and/or constraints:</p> <ul> <li>for a given <code>gene</code> feature</li> <li>each <code>gene</code> entry has at least one <code>transcript</code> feature</li> <li>and each <code>transcript</code> entry has at least one <code>exon</code> feature</li> <li><code>gene_id</code>, <code>gene_name</code> and <code>gene_biotype</code> are required</li> <li>for a given <code>transcipt</code> feature</li> <li>along with <code>gene_id</code>, <code>gene_name</code> and <code>gene_biotype</code> ... <code>transcript_id</code> is also required</li> <li>for a given <code>exon</code> feature</li> <li><code>gene_id</code>, <code>gene_name</code>, <code>gene_biotype</code>, <code>transcript_id</code> are required</li> </ul> <p>If not, the GTF file may need to be manually curated until these conditions are satisfied.</p> <p>Here is an example feature from a hand-curated Biotyn_probe GTF file:</p> <div class=highlight><pre><span></span><code>Biot1<span class=w>   </span>BiotynProbe<span class=w> </span>gene<span class=w>    </span><span class=m>1</span><span class=w>   </span><span class=m>21</span><span class=w>  </span><span class=m>0</span>.000000<span class=w>    </span>+<span class=w>   </span>.<span class=w>   </span>gene_id<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>gene_name<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>gene_biotype<span class=w> </span><span class=s2>&quot;biotynlated_probe_control&quot;</span><span class=p>;</span>
Biot1<span class=w>   </span>BiotynProbe<span class=w> </span>transcript<span class=w>  </span><span class=m>1</span><span class=w>   </span><span class=m>21</span><span class=w>  </span><span class=m>0</span>.000000<span class=w>    </span>+<span class=w>   </span>.<span class=w>   </span>gene_id<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>gene_name<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>gene_biotype<span class=w> </span><span class=s2>&quot;biotynlated_probe_control&quot;</span><span class=p>;</span><span class=w> </span>transcript_id<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>transcript_name<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>transcript_type<span class=w> </span><span class=s2>&quot;biotynlated_probe_control&quot;</span><span class=p>;</span>
Biot1<span class=w>   </span>BiotynProbe<span class=w> </span>exon<span class=w>    </span><span class=m>1</span><span class=w>   </span><span class=m>21</span><span class=w>  </span><span class=m>0</span>.000000<span class=w>    </span>+<span class=w>   </span>.<span class=w>   </span>gene_id<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>gene_biotype<span class=w> </span><span class=s2>&quot;biotynlated_probe_control&quot;</span><span class=p>;</span><span class=w> </span>transcript_id<span class=w> </span><span class=s2>&quot;Biot1&quot;</span><span class=p>;</span><span class=w> </span>transcript_type<span class=w> </span><span class=s2>&quot;biotynlated_probe_control&quot;</span><span class=p>;</span>
</code></pre></div> <p>In this tab-delimited example above,</p> <ul> <li><strong><em>line 1:</em></strong> the <code>gene</code> feature has 3 required attributes in column 9: <code>gene_id</code> and <code>gene_name</code> and <code>gene_biotype</code></li> <li><strong><em>line 2:</em></strong> the <code>transcript</code> entry for the above <code>gene</code> repeats the same attributes with following required fields: <code>transcript_id</code> and <code>transcript_name</code></li> <li><em>Please note:</em> <code>transcript_type</code> is <em>optional</em></li> <li><strong><em>line 3:</em></strong> the <code>exon</code> entry for the above <code>transcript</code> has 3 required attributes: <code>gene_id</code> and <code>transcript_id</code> and <code>gene_biotype</code></li> <li><em>Please note:</em> <code>transcript_type</code> is <em>optional</em></li> </ul> <p>For a given gene, the combination of the <code>gene_id</code> AND <code>gene_name</code> should form a unique string. There should be no instances where two different genes share the same <code>gene_id</code> AND <code>gene_name</code>.</p> <h2 id=4-convert-ncbi-gff3-to-gtf-format>4. Convert NCBI GFF3 to GTF format<a class=headerlink href=#4-convert-ncbi-gff3-to-gtf-format title="Permanent link">&para;</a></h2> <p>It is worth noting that RENEE comes bundled with a script to convert GFF3 files downloaded from NCBI to GTF file format. This convenience script is useful as the <code>renee build</code> sub command takes a GTF file as one of its inputs.</p> <p>Please note that this script has only been tested with GFF3 files downloaded from NCBI, and <em>it is <strong>not</strong> recommended to use with GFF3 files originating from other sources like Ensembl or GENCODE</em>. If you are selecting an annotation from Ensembl or GENCODE, please download the GTF file option.</p> <p>The only dependency of the script is the python package argparse, which comes bundled with the following python&#8532; distributions: <code>python&gt;=2.7.18</code> or <code>python&gt;=3.2</code>. If argparse is not installed, it can be downloaded with pip by running the following command:</p> <div class=highlight><pre><span></span><code>pip<span class=w> </span>install<span class=w> </span>--upgrade<span class=w> </span>pip
pip<span class=w> </span>install<span class=w> </span>argparse
</code></pre></div> <p>For more information about the script and its usage, please run:</p> <div class=highlight><pre><span></span><code>./resources/gff3togtf.py<span class=w> </span>-h
</code></pre></div> <h2 id=5-example>5. Example<a class=headerlink href=#5-example title="Permanent link">&para;</a></h2> <h3 id=51-biowulf>5.1 Biowulf<a class=headerlink href=#51-biowulf title="Permanent link">&para;</a></h3> <p>On Biowulf getting started with the pipeline is fast and easy! In this example, we build a mouse reference genome.</p> <div class=highlight><pre><span></span><code><span class=c1># Step 0.) Grab an interactive node (do not run on head node)</span>
srun<span class=w> </span>-N<span class=w> </span><span class=m>1</span><span class=w> </span>-n<span class=w> </span><span class=m>1</span><span class=w> </span>--time<span class=o>=</span><span class=m>2</span>:00:00<span class=w> </span>-p<span class=w> </span>interactive<span class=w> </span>--mem<span class=o>=</span>8gb<span class=w>  </span>--cpus-per-task<span class=o>=</span><span class=m>4</span><span class=w> </span>--pty<span class=w> </span>bash
module<span class=w> </span>purge
module<span class=w> </span>load<span class=w> </span>ccbrpipeliner

<span class=c1># Step 1.) Dry run the Build pipeline</span>
renee<span class=w> </span>build<span class=w> </span>--ref-fa<span class=w> </span>GRCm39.primary_assembly.genome.fa<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-name<span class=w> </span>mm39<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-gtf<span class=w> </span>gencode.vM26.annotation.gtf<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--gtf-ver<span class=w> </span>M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--output<span class=w> </span>/data/<span class=nv>$USER</span>/refs/mm39_M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--sif-cache<span class=w> </span>/data/CCBR_Pipeliner/SIFs/<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--dry-run

<span class=c1># Step 2.) Build new RENEE reference files</span>
renee<span class=w> </span>build<span class=w> </span>--ref-fa<span class=w> </span>GRCm39.primary_assembly.genome.fa<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-name<span class=w> </span>mm39<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-gtf<span class=w> </span>gencode.vM26.annotation.gtf<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--gtf-ver<span class=w> </span>M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--output<span class=w> </span>/data/<span class=nv>$USER</span>/refs/mm39_M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--sif-cache<span class=w> </span>/data/CCBR_Pipeliner/SIFs/<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--partition<span class=w> </span>norm
</code></pre></div> <h3 id=52-generic-slurm-cluster>5.2 Generic SLURM Cluster<a class=headerlink href=#52-generic-slurm-cluster title="Permanent link">&para;</a></h3> <p>Running the pipeline outside of Biowulf is easy; however, there are a few extra options you must provide. Please note when running the build sub command for the first time, you will also need to provide the <code>--shared-resources</code> option. This option will download our kraken2 database and bowtie2 indices for FastQ Screen. The path provided to this option should be provided to the <code>--shared-resources</code> option of the <a href=./RNA-seq/cache/ >run</a> sub command. Next, you will also need to provide a path to write temporary output files via the <code>--tmp-dir</code> option. We also recommend providing a path to a SIF cache. You can cache software containers locally with the <a href=./RNA-seq/cache/ >cache</a> sub command.</p> <div class=highlight><pre><span></span><code><span class=c1># Step 0.) Grab an interactive node (do not run on head node)</span>
srun<span class=w> </span>-N<span class=w> </span><span class=m>1</span><span class=w> </span>-n<span class=w> </span><span class=m>1</span><span class=w> </span>--time<span class=o>=</span><span class=m>2</span>:00:00<span class=w> </span>-p<span class=w> </span>interactive<span class=w> </span>--mem<span class=o>=</span>8gb<span class=w>  </span>--cpus-per-task<span class=o>=</span><span class=m>4</span><span class=w> </span>--pty<span class=w> </span>bash
<span class=c1># Add snakemake and singularity to $PATH,</span>
<span class=c1># This step may vary across clusters, you</span>
<span class=c1># can reach out to a sys admin if snakemake</span>
<span class=c1># and singularity are not installed.</span>
module<span class=w> </span>purge
<span class=c1># Replace the following:</span>
<span class=c1># module load ccbrpipeliner</span>
<span class=c1># with module load statements that load</span>
<span class=c1># python &gt;= 3.7,</span>
<span class=c1># snakemake, and</span>
<span class=c1># singularity</span>
<span class=c1># before running renee</span>
<span class=c1># Also, ensure that the `renee` executable is in PATH</span>

<span class=c1># Step 1.) Dry run the Build pipeline</span>
renee<span class=w> </span>build<span class=w> </span>--ref-fa<span class=w> </span>GRCm39.primary_assembly.genome.fa<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-name<span class=w> </span>mm39<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-gtf<span class=w> </span>gencode.vM26.annotation.gtf<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--gtf-ver<span class=w> </span>M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--output<span class=w> </span>/data/<span class=nv>$USER</span>/refs/mm39_M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--shared-resources<span class=w> </span>/data/shared/renee<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--tmp-dir<span class=w> </span>/cluster_scratch/<span class=nv>$USER</span>/<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--sif-cache<span class=w> </span>/data/<span class=nv>$USER</span>/cache<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--dry-run

<span class=c1># Step 2.) Build new RENEE reference files</span>
renee<span class=w> </span>build<span class=w> </span>--ref-fa<span class=w> </span>GRCm39.primary_assembly.genome.fa<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-name<span class=w> </span>mm39<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--ref-gtf<span class=w> </span>gencode.vM26.annotation.gtf<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--gtf-ver<span class=w> </span>M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--output<span class=w> </span>/data/<span class=nv>$USER</span>/refs/mm39_M26<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--shared-resources<span class=w> </span>/data/shared/renee<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--tmp-dir<span class=w> </span>/cluster_scratch/<span class=nv>$USER</span>/<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--sif-cache<span class=w> </span>/data/<span class=nv>$USER</span>/cache<span class=w> </span><span class=se>\</span>
<span class=w>              </span>--partition<span class=w> </span>norm
</code></pre></div> </div> </div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3SL9V30KL"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3SL9V30KL'); // Replace with your tracking ID
</script> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span> <a href=https://github.com/CCBR/RENEE class="fa fa-code-fork" style="color: #fcfcfc"> CCBR/RENEE</a> </span> <span><a href=../run/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../cache/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../../js/jquery-3.6.0.min.js></script> <script>var base_url = "../..";</script> <script src=../../js/theme_extra.js></script> <script src=../../js/theme.js></script> <script src=../../js/custom.js></script> <script src=../../search/main.js></script> <script src=../../js/version-select.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 