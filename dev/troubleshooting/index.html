<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=CCBR><link rel="shortcut icon" href=../img/favicon.ico><title>Troubleshooting - RENEE Documentation</title><link rel=stylesheet href=../css/theme.css><link rel=stylesheet href=../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><link href=../css/custom.css rel=stylesheet><link href=../css/version-select.css rel=stylesheet><script>
        // Current page data
        var mkdocs_page_name = "Troubleshooting";
        var mkdocs_page_input_path = "troubleshooting.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=.. class="icon icon-home"> RENEE Documentation </a><div role=search> <form id=rtd-search-form class=wy-form action=../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=..>About</a> </li> </ul> <ul> <li class=toctree-l1><a href=../RNA-seq/Theory/ class="reference internal">Theory</a> </li> </ul> <ul> <li class=toctree-l1><a href=../RNA-seq/TLDR-RNA-seq/ class="reference internal">Getting started</a> </li> </ul> <p class=caption><span class=caption-text>Command Line</span></p> <ul> <li class=toctree-l1><a href=../RNA-seq/run/ class="reference internal">run</a> </li> <li class=toctree-l1><a href=../RNA-seq/build/ class="reference internal">build</a> </li> <li class=toctree-l1><a href=../RNA-seq/cache/ class="reference internal">cache</a> </li> <li class=toctree-l1><a href=../RNA-seq/unlock/ class="reference internal">unlock</a> </li> </ul> <ul> <li class=toctree-l1><a href=../RNA-seq/gui/ class="reference internal">Graphical Interface</a> </li> </ul> <ul> <li class=toctree-l1><a href=../RNA-seq/output/ class="reference internal">Expected Output</a> </li> </ul> <ul> <li class=toctree-l1><a href=../RNA-seq/Resources/ class="reference internal">Resources</a> </li> </ul> <p class=caption><span class=caption-text>FAQ</span></p> <ul class=current> <li class=toctree-l1><a href=../general-questions/ class="reference internal">General Questions</a> </li> <li class="toctree-l1 current"><a class="reference internal current" href=#>Troubleshooting</a> <ul class=current> </ul> </li> <li class=toctree-l1><a href=../contributing/ class="reference internal">How to contribute</a> </li> </ul> <ul> <li class=toctree-l1><a href=../license/ class="reference internal">License</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=..>RENEE Documentation</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=.. class="icon icon-home" aria-label=Docs></a></li> <li class=breadcrumb-item>FAQ</li> <li class="breadcrumb-item active">Troubleshooting</li> <li class=wy-breadcrumbs-aside> <a href=https://github.com/CCBR/RENEE/edit/master/docs/troubleshooting.md>Edit on CCBR/RENEE</a> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <p>If you are experiencing an issue, please read through this list first before contacting our team.</p> <p>We have compiled this FAQ from the most common problems. If you are running into an issue that is not on this page, please feel free to <a href=https://github.com/CCBR/RENEE/issues>reach out to our team</a>.</p> <h2 id=job-status>Job Status<a class=headerlink href=#job-status title="Permanent link">&para;</a></h2> <p><strong>Q: How do I know if RENEE pipeline finished running? How to check status of each job?</strong></p> <p><strong>A.</strong> Once the pipeline is done running to completion, you will receive an email with header like</p> <p><code>Slurm Job_id=xxxx Name=pl:renee Ended, Run time xx:xx:xx, COMPLETED, ExitCode 0</code></p> <p>To check the status of each individual job submitted to the cluster, there are several different ways. Here are a few suggestions:</p> <div class="admonition tldr"> <p class=admonition-title>Check Job Status</p> <div class=tabbed-set data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>Biowulf Dashboard</label><div class=tabbed-content> <p>You can check the status of Biowulf jobs through the your <a href=https://hpc.nih.gov/dashboard/ >user dashboard</a>.</p> <p>Each job that RENEE submits to the cluster starts with the <code>pl:</code> prefix.</p> </div> <input id=__tabbed_1_2 name=__tabbed_1 type=radio><label for=__tabbed_1_2>Query Job Scheduler</label><div class=tabbed-content> <p>SLURM has built-in commands that allow a user to view the status of jobs submitted to the cluster.</p> <p><strong>Method 1:</strong> To see what jobs you have running, run the following command: <div class=highlight><pre><span></span><code>squeue<span class=w> </span>-u<span class=w> </span><span class=nv>$USER</span>
</code></pre></div></p> <p><strong>Method 2</strong> You can also run this alternative command to check the status of your running jobs: <div class=highlight><pre><span></span><code>sjobs
</code></pre></div></p> <p>Each job that RENEE submits to the cluster starts with the <code>pl:</code> prefix.</p> </div> </div> </div> <p><strong>Q: What if the pipeline is finished running but I received a "FAILED" status? How do I identify failed jobs?</strong></p> <p><strong>A.</strong> In case there was some error during the run, the easiest way to diagnose the problem is to go to logfiles folder within the RENEE output folder and look at the <code>snakemake.log.jobby.short</code> file. It contains three columns: jobname, state, and std_err. The jobs that completed successfully would have "COMPLETED" state and jobs that failed would have the FAILED state.</p> <div class="admonition tldr"> <p class=admonition-title>Find Failed Jobs</p> <div class=tabbed-set data-tabs=2:1><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><label for=__tabbed_2_1>SLURM output files</label><div class=tabbed-content> <p>All the failed jobs would be listed with absolute paths to the error file (with extension <code>.err</code>). Go through the error files corresponding to the FAILED jobs (std_err) to explore why the job failed.</p> <div class=highlight><pre><span></span><code><span class=c1># Go to the logfiles folder within the renee output folder</span>
<span class=nb>cd</span><span class=w> </span>renee_output/logfiles

<span class=c1># List the files that failed</span>
grep<span class=w> </span><span class=s2>&quot;FAILED&quot;</span><span class=w> </span>snakemake.log.jobby.short<span class=w> </span><span class=p>|</span><span class=w> </span>less
</code></pre></div> </div> </div> </div> <p>Many failures are caused by filesystem or network issues on Biowulf, and in such cases, simply re-starting the Pipeline should resolve the issue. Snakemake will dynamically determine which steps have been completed, and which steps still need to be run. If you are still running into problems after re-running the pipeline, there may be another issue. If that is the case, please feel free to <a href=https://github.com/CCBR/RENEE/issues>contact us</a>.</p> <p><strong>Q. How do I cancel ongoing RENEE jobs?</strong></p> <p><strong>A.</strong> Sometimes, you might need to manually stop a RENEE run prematurely, perhaps because the run was configured incorrectly or if a job is stalled. Although the walltime limits will eventually stop the workflow, this can take up to 5 or 10 days depending on the pipeline.</p> <p>To stop RENEE jobs that are currently running, you can follow these options.</p> <div class="admonition tldr"> <p class=admonition-title>Cancel running jobs</p> <div class=tabbed-set data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><label for=__tabbed_3_1>Master Job</label><div class=tabbed-content> <p>You can use the <code>sjobs</code> tool <a href=https://hpc.nih.gov/docs/biowulf_tools.html#sjobs>provided by Biowulf</a> to monitor ongoing jobs.</p> <p>Examine the <code>NAME</code> column of the <code>sjobs</code> output, one of them should match <code>pl:renee</code>. This is the "primary" job that orchestrates the submission of child jobs as the pipeline completes. Terminating this job will ensure that the pipeline is cancelled; however, you will likely need to unlock the working directory before re-running renee again. Please see our instructions below in <code>Error: Directory cannot be locked</code> for how to unlock a working directory.</p> <p>You can <a href=https://hpc.nih.gov/docs/userguide.html#delete>manually cancel</a> the primary job using <code>scancel</code>.</p> <p>However, secondary jobs that are already running will continue to completion (or failure). To stop them immediately, you will need to run <code>scancel</code> individually for each secondary job. See the next tab for a bash script that tries to automate this process.</p> </div> <input id=__tabbed_3_2 name=__tabbed_3 type=radio><label for=__tabbed_3_2>Child Jobs</label><div class=tabbed-content> <p>When there are lots of secondary jobs running, or if you have multiple RENEE runs ongoing simultaneously, it's not feasible to manually cancel jobs based on the <code>sjobs</code> output (see previous tab).</p> <p>We provide <a href=https://github.com/CCBR/Tools/blob/c3324fc0ad2f9858438c84bbb2f24927a8f3a220/scripts/cancel_snakemake_jobs.sh>a script</a> that will parse the snakemake log file and cancel all jobs listed within.</p> <div class=highlight><pre><span></span><code><span class=c1>## Download the script (to the current directory)</span>
wget<span class=w> </span>https://raw.githubusercontent.com/CCBR/Tools/c3324fc0ad2f9858438c84bbb2f24927a8f3a220/scripts/cancel_snakemake_jobs.sh

<span class=c1>## Run the script</span>
bash<span class=w> </span>cancel_snakemake_jobs.sh<span class=w> </span>/path/to/output/logfiles/snakemake.log
</code></pre></div> <p>The script accepts one argument, which should be the path to the snakemake log file. This will work for any log output from Snakemake.</p> <p>This script will NOT cancel the primary job, which you will still have to identify and cancel manually, as described in the previous tab.</p> </div> </div> </div> <p>Once you've ensured that all running jobs have been stopped, you need to unlock the working directory (see below), and re-run RENEE to resume the pipeline.</p> <h2 id=job-errors>Job Errors<a class=headerlink href=#job-errors title="Permanent link">&para;</a></h2> <p><strong>Q. Why am I getting <code>sbatch: command not found error</code>?</strong></p> <p><strong>A.</strong> Are you running the <code>renee</code> on <code>helix.nih.gov</code> by mistake? <a href=https://hpc.nih.gov/systems/ >Helix</a> does not have a job scheduler. One may be able to fire up the singularity module, initial working directory and perform dry-run on <code>helix</code>. But to submit jobs, you need to log into <code>biowulf</code> using <code>ssh -Y username@biowulf.nih.gov</code>.</p> <p><strong>Q. Why am I getting a message saying <code>Error: Directory cannot be locked. ...</code> when I do the dry-run?</strong></p> <p><strong>A.</strong> This is caused when a run is stopped prematurely, either accidentally or on purpose, or the pipeline is still running in your working directory. Snakemake will lock a working directory to prevent two concurrent pipelines from writing to the same location. This can be remedied easily by running <code>renee unlock</code> sub command. Please check to see if the pipeline is still running prior to running the commands below. If you would like to cancel a submitted or running pipeline, please reference the instructions above.</p> <div class=highlight><pre><span></span><code><span class=c1># Load Dependencies</span>
module<span class=w> </span>load<span class=w> </span>ccbrpipeliner

<span class=c1># Unlock the working directory</span>
renee<span class=w> </span>unlock<span class=w> </span>--output<span class=w> </span>/path/to/working/dir
</code></pre></div> <p><strong>Q. Why am I getting a message saying <code>MissingInputException in line ...</code> when I do the dry-run?</strong></p> <p><strong>A.</strong> This error usually occurs when snakemake is terminated ungracefully. Did you forcefully cancel a running pipeline? Or did one of your running pipelines abruptly end? Either way, the solution is straight-forward. Please go to your pipeline's output directory, and rename or delete the following hidden directory: <code>.snakemake/</code>. This directory contains metadata pertaining any snakemake runs inside that working directory. Sometimes when a pipeline is pre-maturely or forcefully terminated, a few files related to tracking temp() files are not deleted and snakemake raises a MissingInputException.</p> <div class=highlight><pre><span></span><code><span class=c1># Navigate to working directory</span>
<span class=nb>cd</span><span class=w> </span>/path/to/working/dir

<span class=c1># Rename .snakemake directory to something else</span>
<span class=c1># And try re-dry running the pipeline</span>
mv<span class=w> </span>.snakemake<span class=w> </span>.old_snakemake
</code></pre></div> </div> </div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3SL9V30KL"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3SL9V30KL'); // Replace with your tracking ID
</script> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span> <a href=https://github.com/CCBR/RENEE class="fa fa-code-fork" style="color: #fcfcfc"> CCBR/RENEE</a> </span> <span><a href=../general-questions/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../contributing/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../js/jquery-3.6.0.min.js></script> <script>var base_url = "..";</script> <script src=../js/theme_extra.js></script> <script src=../js/theme.js></script> <script src=../js/custom.js></script> <script src=../search/main.js></script> <script src=../js/version-select.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 